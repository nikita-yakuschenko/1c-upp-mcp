# MCP —Å–µ—Ä–≤–µ—Ä —Å RAG –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ 1–°

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞ Youtube:
[![–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è MCP —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ 1–°](https://i.ytimg.com/vi/74kYcK6bvGk/sd3.jpg)](http://www.youtube.com/watch?v=74kYcK6bvGk)

[**–ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ —Å—Ç–∞—Ç—å–µ**](https://github.com/FSerg/mcp-1c-v1/blob/main/article/article.md    ).

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ 1C:

1. **Embedding Service** - —Å–µ—Ä–≤–∏—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π
2. **–ü–æ–ª—É—á–∏—Ç—å–¢–µ–∫—Å—Ç–°—Ç—Ä—É–∫—Ç—É—Ä—ã–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏–§–∞–π–ª–∞–º–∏.epf** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ 1–°
3. **Loader** - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞—Ä—Ö–∏–≤–∞ –≤—ã–≥—Ä—É–∑–∫–∏ –∏–∑ 1–° –≤ –≤–µ–∫—Ç–æ—Ä–Ω—É—é –ë–î Qdrant
4. **MCP Server** - —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º RAG

## –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üöÄ –ú—É–ª—å—Ç–∏–≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫

MCP —Å–µ—Ä–≤–µ—Ä —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º—É–ª—å—Ç–∏–≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º RRF (Reciprocal Rank Fusion):

- **–î–≤–∞ –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è**: `object_name` –∏ `friendly_name` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
- **RRF –∞–ª–≥–æ—Ä–∏—Ç–º**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –ø–æ —Ä–∞–∑–Ω—ã–º –≤–µ–∫—Ç–æ—Ä–∞–º
- **–£–ª—É—á—à–µ–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å**: –±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞
- **Backward compatibility**: –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–ª—é—á–∏—Ç—å –º—É–ª—å—Ç–∏–≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫

üìñ [–ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –º—É–ª—å—Ç–∏–≤–µ–∫—Ç–æ—Ä–Ω–æ–º –ø–æ–∏—Å–∫–µ](mcp/MULTIVECTOR_SEARCH.md)

## –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
chmod +x start.sh && chmod +x stop.sh
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./start.sh

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
docker-compose up --build
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
./stop.sh

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
docker-compose down
```

## –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã:

- **Loader (Streamlit)**: http://localhost:8501 - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤
- **Embedding Service**: http://localhost:5000 - API –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
- **Qdrant**: http://localhost:6333/dashboard - –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **MCP Server**: http://localhost:8000/mcp - —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã
- **MCP Inspector**: http://localhost:6274 - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ–≤–µ—Ä–∫–∏/–æ—Ç–ª–∞–¥–∫–∏ MCP —Å–µ—Ä–≤–µ—Ä–æ–≤

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
mcp-1c-v1/
‚îú‚îÄ‚îÄ embeddings/           # –°–µ—Ä–≤–∏—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ embedding_service.py
‚îÇ   ‚îú‚îÄ‚îÄ config.json
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ loader/              # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ loader.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ mcp/                 # MCP 1–° RAG —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ mcp_server.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ inspector/           # MCP Inspector
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ mcp_server.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ –ü–æ–ª—É—á–∏—Ç—å–¢–µ–∫—Å—Ç–°—Ç—Ä—É–∫—Ç—É—Ä—ã–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏–§–∞–∏ÃÜ–ª–∞–º–∏.epf # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è 1–° –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ docker-compose.yml  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ start.sh            # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îî‚îÄ‚îÄ stop.sh             # –°–∫—Ä–∏–ø—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã: `./start.sh`
2. –í—ã–≥—Ä—É–∑–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ 1–°: `–ü–æ–ª—É—á–∏—Ç—å–¢–µ–∫—Å—Ç–°—Ç—Ä—É–∫—Ç—É—Ä—ã–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏–§–∞–∏ÃÜ–ª–∞–º–∏.epf`
3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–∞–≥—Ä—É–∑—á–∏–∫–∞: http://youraddress:8501
4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ ZIP-–∞—Ä—Ö–∏–≤ —Å markdown —Ñ–∞–π–ª–∞–º–∏ –∏ —Ñ–∞–π–ª–æ–º objects.csv
5. –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É"
6. –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Qdrant –¥–ª—è –ø–æ–∏—Å–∫–∞ —á–µ—Ä–µ–∑ MCP Server

–î–ª—è –∞–≥–µ–Ω—Ç–æ–≤ (Cursor, RooCode) –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª Streamable HTTP, —É–∫–∞–∑—ã–≤–∞–µ–º: http://youaddress:8000/mcp
–î–ª—è VSCode Copilot, —Ö–æ—Ç—å –∏ –∑–∞—è–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Streamable HTTP, –Ω–æ —É –º–µ–Ω—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–∞–∫ SSE, –ø–æ—ç—Ç–æ–º—É —É–∫–∞–∑—ã–≤–∞–ª: http://youraddress:8000/mcp/sse

**–î–ª—è VSCode Copilot .../YourProject/.vscode/mcp.json**
```json
{
    "servers": {
        "my-1c-mcp-server": {
            "headers": {
                "x-collection-name": "my_vector_collection"
            },
            "url": "http://youraddress:8000/mcp/sse"
        }
    }
}
```

**–î–ª—è Cursor .../YourProject/.cursor/mcp.json**
```json
{
    "servers": {
        "my-1c-mcp-server": {
            "headers": {
                "x-collection-name": "my_vector_collection"
            },
            "url": "http://youraddress:8000/mcp"
        }
    }
}
```
–ß–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `x-collection-name` –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∏–º—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ Qdrant –≤–º–µ—Å—Ç–æ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–≥–æ `1c_rag`. –¢.–∫. –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ MCP –ø–æ—á—Ç–∏ –≤–µ–∑–¥–µ –º–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞, —Ç–æ —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∏–Ω—Å—Ç–∞–Ω—Å MCP —Å–µ—Ä–≤–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ (–¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π 1–°).

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

- `EMBEDDING_SERVICE_URL` - URL —Å–µ—Ä–≤–∏—Å–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: http://youraddress:5000)
- `QDRANT_HOST` - —Ö–æ—Å—Ç Qdrant (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: localhost)
- `QDRANT_PORT` - –ø–æ—Ä—Ç Qdrant (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 6333)
- `COLLECTION_NAME` - –∏–º—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ Qdrant (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1c_rag), –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `x-collection-name` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è MCP —Å–µ—Ä–≤–µ—Ä–∞
- `ROW_BATCH_SIZE` - —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ —Å—Ç—Ä–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 250)
- `EMBEDDING_BATCH_SIZE` - —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50)

## –û—Ç–ª–∞–¥–∫–∞

–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:

```bash
# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f loader
docker-compose logs -f embedding-service
docker-compose logs -f qdrant
docker-compose logs -f mcp-server

# –õ–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose logs -f
```
